<!DOCTYPE HTML>
<html>
<head>
<title>GCMC water silica</title>

<link rel="shortcut icon" type="image/jpg" href="favicon-32x32.png"/>

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<link rel="stylesheet" href="assets_internalpages/css/main.css" />
	
<script async src="https://www.googletagmanager.com/gtag/js?id=G-W1WGEC5GQ8"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-W1WGEC5GQ8');
</script>	
	
<!-- Latex formula -->
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body class="is-preload">

<!-- Header -->
<section id="header">
<header>
<span class="image avatar"><a href="index.html"><img src="Figures/avatar_larger.png" alt="" /></a></span>
<h1 id="logo"><a href="index.html">LAMMPS tutorials</a></h1>
<p>by Simon Gravelle</p>
</header>
<nav id="nav">
<ul>
<li><a href="#welcome" class="active">Welcome</a></li>
<li><a href="#generation">System generation</a></li>
<li><a href="#input">LAMMPS input script</a></li>
</ul>
</nav>
<footer>
<ul class="icons">
<li><a href="https://twitter.com/GravelleSimon" target="_blank" class="icon brands fa-twitter"><span class="label"></span></a></li>
<li><a href="https://github.com/simongravelle" target="_blank" class="icon brands fa-github"><span class="label"></span></a></li>
<li><a href="https://scholar.google.com/citations?user=9fD2JlYAAAAJ&hl=fr" target="_blank"  class="fa fa-graduation-cap"><span class="label"></span></a></li>
<li><a href="https://orcid.org/0000-0003-2149-6706" target="_blank"><span class="label">iD</span></a></li>
<li><a href="https://www.youtube.com/channel/UCLmK_9wpyLVpcP7BPgN6BIw?view_as=subscriber" target="_blank" class="fab fa-youtube"><span class="label"></span></a></li>
</ul>

</footer>
</section>

<!-- Wrapper -->
<div id="wrapper">

<!-- Main -->
<div id="main">
<section id="welcome">
<div class="image main" data-position="center">
<img src="Figures/banner_tutorial04.jpg" alt="" />
</div>
<div class="container">
<header class="major">
<h2>Adsorption of water in a crack</h2>
<p>Adsorption of water in a silica crack using the grand canonical Monte Carlo method.</p>
</header>
</section>

<section>
<div class="container">


<p>
<b>Objective:</b> The purpose of this tutorial is to combine molecular dynamics and grand canonical Monte Carlo and simulate the adsorption of water molecules in a block of silica that contains a crack. If you already have a good grasp on LAMMPS, you can download directly the input scripts that will be written following this tutorial by clicking <a href="Inputs/" target="_blank" class="removelinkdefault">here</a>.

<br><br>

<b>Prerequisite:</b> If you are new to LAMMPS, I recommend you to follow <a href="tutorial01.html">tutorial 01</a> first. 

<blockquote>
<b><i>Note 1 - </i></b> If you have any suggestion about these tutorials, please contact me by email at simon.gravelle at live.fr.

<br><br>

<b><i>Note 2 - </i></b> You can support me for 1 euro per month by clicking  <a href=" https://www.patreon.com/molecularsimulations" target="_blank">here</a>. For a larger amount, I offer you <b>personal assistance</b> with you LAMMPS scripts.
</a>
</blockquote>

</div>
</section>

<section id="generation">
<div class="container"> 

<h2>Generation of the silica block</h2>

<p>Let us generate a block of amorphous silica (SiO2). To do so, we are going to replicate a building block containing 3 Si and 6 O atoms. The data file for the SiO atoms can be downloaded by clicking <a href="Data/tutorial05/dataSiO.data" target="_blank" class="removelinkdefault">here</a>. This data file contains the coordinates of the atoms, their masses, and their charges, and can be directly read by LAMMPS using the read_file command. Let us replicate this molecule using LAMMPS, and apply an annealing procedure to obtain a block of amorphous silica.

<br><br>

Create a new input file in the same folder as the downloaded dataSiO.data, and copy the following line in it. <pre><code>##################
# Initialization #
##################

units		    	metal
boundary            	p p p
atom_style          	full
pair_style 		vashishta
neighbor	    	1.0 bin
neigh_modify	    	delay 1

#####################
# System definition #
#####################

read_data           	data.SiO
replicate		4 4 4
</code></pre></p><p>
Metalic units are used as required by the Vashishta potential. The <a href="https://pubmed.ncbi.nlm.nih.gov/9993674/" target="_blank" class="removelinkdefault">Vashishta</a> potential is a bond-angle energy based potential. This family of potential deduces which atoms are bonded together from their relative positions. Therefore we don't need to provide bond and angle information as we do with classic force field. These kind of potential are more computationally heavy than classical force field and require the use of a smaller timestep, but allow for the modelling of bond formation/breaking, which is what we need here as we want to create a crack in the silica. You can download it by clicking <a href="Data/tutorial05/SiO.1990.vashishta" target="_blank" class="removelinkdefault">here</a>

The system is then replicated four times in all three directions of space. Then add the pair coeff, where we indicate that the first atom is Si, and the second is O, and add a dump for printing atoms trajectories:
<pre><code>#######################
# Simulation settings #
#######################

pair_coeff		* *  SiO.1990.vashishta Si O
dump 			dmp all atom 5000 dump.lammpstrj
</code></pre></p><p>
Finally, let us create the run part of our script. We first start with a small phase at 6000 K, then cool down the system to 4000 K using a pressure of 100 atm. Then we cool down the system further while also reducing the pressure, then perform a small equilibration step at the final desired condition, 3 00K and 1 atm.
<pre><code>#######
# Run #
#######

velocity 		all create 6000 4928459 rot yes dist gaussian
fix 			nvt1 all nvt temp 6000 6000 0.1

timestep		0.001
thermo          	1000
run			5000
unfix			nvt1

fix 			npt1 all npt temp 6000 4000 0.1 aniso 100 100 1

run			50000

fix 			npt1 all npt temp 4000 300 0.1 aniso 100 1 1

run			200000

fix 			npt1 all npt temp 300 300 0.1 aniso 1 1 1

run			4000

write_data 		data.amorphousSiO
</code></pre></p><p>
Note the use of the anisotropic pressure, so that all three directions of space are managed independently, which is better for a solid phase like here. For a liquid of a gas, use iso instead.


</div>
</section>

<section id="generation">
<div class="container"> 

<h2>Addition of water</h2>

In order to add the water molecules, we are going to use the Monte Carlo method in the grand canonical ensemble (GCMC). In short, the system is put in contact with a virtual reservoir of given chemical potential, and multiple attempts to insert water molecules at random positions are made. Attemps are either accepted or rejected based on an acceptance rule. 

<br><br>

<blockquote>
<b><i>Note 3 - </i></b> Cellulose is a hygroscopic material that swell with water. However, GCMC simulations are performed at constant volume (ie they do not allow the volume of the box to adjust). Therefore, we are going to alternate between GCMC steps and NPT steps. This method is sometimes called hybrid GCMC-NPT. 
</blockquote>

In a different folder, copy the <a href="Data/tutorial05_equilibrium.data" target="_blank" class="removelinkdefault">data</a> file previously generated as well as the <a href="Data/tutorial05_PARM" target="_blank" class="removelinkdefault">parameters</a> file previously used. Also copy the <a href="Data/TIP4P2005.txt" target="_blank" class="removelinkdefault">TIP4P2005.txt</a> file which contains the information concerning the water model. Create a new input file, and copy the following lines into it:



</div>
</section>

<section id="generation">
<div class="container"> 

</div>
</section>

</div>



				<!-- Footer -->
					<section id="footer">
						<div class="container">
							<ul class="copyright">
								<li>&copy; Untitled. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
							</ul>
						</div>
					</section>

			</div>

		<!-- Scripts -->
			<script src="assets_internalpages/js/jquery.min.js"></script>
			<script src="assets_internalpages/js/jquery.scrollex.min.js"></script>
			<script src="assets_internalpages/js/jquery.scrolly.min.js"></script>
			<script src="assets_internalpages/js/browser.min.js"></script>
			<script src="assets_internalpages/js/breakpoints.min.js"></script>
			<script src="assets_internalpages/js/util.js"></script>
			<script src="assets_internalpages/js/main.js"></script>

	</body>
</html>
